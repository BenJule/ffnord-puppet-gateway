#!/bin/bash

IP4TABLES=$(which iptables)
IP6TABLES=$(which ip6tables)

## Wrapper function for iptables - IPv4 version
function ip4tables() {
  echo -e "\t iptables $*"
  $IP4TABLES $*
}

## Wrapper function for iptables - IPv6 version
function ip6tables() {
  echo -e "\t ip6tables $*"
  $IP6TABLES $*
}

## Wrapper function for iptables - IPv{4,6} version
# should only be used for statements which apply
# for both iptables versions.
function ip46tables() {
  ip4tables $*
  ip6tables $*
}

## Create a filter rule which blocks the given ip-range
# IPv4 Verion
# #1: iptables chain
# #2: IP-Range to block in a iptables compatible format
function block4(){
  local chain="$1"
  local iprange="$2"
  ip4tables -t filter -A "$chain" -s "$iprange" -j DROP
}

## Create a filter rule which blocks the given ip-range
# IPv6 Version
# #1: iptables chain
# #2: IP-Range to block in a iptables compatible format
function block6(){
  local chain="$1"
  local iprange="$2"
  ip6tables -t filter -A "$chain" -s "$iprange" -j DROP
}

for rules in /etc/iptables.d/*; do
   echo "File: $rules"
   . $rules
done
