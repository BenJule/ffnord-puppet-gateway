# this is file is  generated by puppet

# bird6 icvpn peers configuration

template bgp icvpn from icvpn_template {
  source address <%= @icvpn_ipv6_address %>;
}
<% @icvpn_peerings.each do |peer| -%>
<% meta = YAML.load_file("/etc/tinc/icvpn/meta/" + peer + ".yaml") -%>
<% meta[peer]['icvpn-peers'].each_pair do |name,node| -%>

protocol bgp <%= peer %>_<%= name %> from icvpn_peer {
  neighbor <%= node['ipv6'] %> as <%= meta[peer]['as'] %>;
};
<% end -%>
<% end -%>
